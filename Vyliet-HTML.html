<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Vyliet.com</title>
  <!-- External scripts -->
  <script src="filters.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.9.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.9.0/firebase-auth.js"></script>
  <script src="firebase.js"></script>
  <style>
    body {
      font-family: sans-serif;
      margin: 0;
      background: white;
      color: #333;
    }
  
    header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 15px 20px;
      border-bottom: 1px solid #ddd;
      box-shadow: 0 2px 4px rgba(0,0,0,0.05);
      background-color: #ffffff;
      margin-bottom: 25px;
      margin-top: 10px;
      margin-left: 10px;
      margin-right: 10px;
      border-radius: 6px;
    }
  
    .search-container {
      display: flex;
      align-items: center;
      flex: 1;
      margin: 0 24px;
      gap: 10px;
    }
  
    .search-input-wrapper {
      position: relative;
      display: flex;
      align-items: center;
      width: 100%;
    }
  
    .search-icon {
      position: absolute;
      left: 12px;
      color: #666;
      cursor: pointer;
      transition: color 0.3s ease;
    }
  
    .search-icon:hover {
      color: #333;
    }
  
    #searchInput {
      padding-left: 40px;
      width: 100%;
      height: 40px;
      border: 1px solid #ddd;
      border-radius: 20px;
      font-size: 16px;
      outline: none;
      transition: border-color 0.3s ease;
    }
  
    #searchInput:focus {
      border-color: #4a90e2;
    }
  
    .clear-button {
      position: absolute;
      right: 8px;
      top: 50%;
      transform: translateY(-50%);
      background: none;
      border: none;
      color: #999;
      cursor: pointer;
      padding: 4px;
      width: 24px;
      height: 24px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 50%;
      opacity: 0;
      visibility: hidden;
      transition: all 0.2s ease;
    }
  
    .search-input-wrapper:hover .clear-button,
    .search-container input:focus + .clear-button {
      opacity: 1;
      visibility: visible;
    }
  
    .clear-button:hover {
      color: #666;
      background-color: #f0f0f0;
    }
  
    .clear-button:active {
      transform: translateY(-50%) scale(0.95);
    }
  
    .dropdown, .filters .dropdown {
      position: relative;
      display: inline-block;
    }
  
    .dropdown {
      padding: 8px 16px;
      border-radius: 9999px;
      border: 1px solid #ddd;
      background: white;
      cursor: pointer;
      font-size: 14px;
      color: #333;
      appearance: none;
      -webkit-appearance: none;
      -moz-appearance: none;
      background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e");
      background-repeat: no-repeat;
      background-position: right 8px center;
      background-size: 16px;
      padding-right: 32px;
      transition: all 0.3s ease;
    }
  
    .dropdown:hover {
      border-color: #4a90e2;
      color: #4a90e2;
    }
  
    .dropdown:focus {
      outline: none;
      border-color: #4a90e2;
      box-shadow: 0 0 0 2px rgba(74, 144, 226, 0.1);
    }
  
    .dropdown-content {
      display: none;
      position: absolute;
      background-color: white;
      min-width: 160px;
      box-shadow: 0px 8px 16px rgba(0,0,0,0.1);
      border: 1px solid #ccc;
      border-radius: 8px;
      z-index: 1;
      top: 110%;
    }
  
    .dropdown-content a {
      color: black;
      padding: 10px 16px;
      display: block;
      text-decoration: none;
    }
  
    .dropdown-content a:hover {
      background-color: #f1f1f1;
    }
  
    .dropdown.show .dropdown-content {
      display: block;
    }
  
    .action-buttons {
      display: flex;
      align-items: center;
      gap: 12px;
      height: 40px;
      margin-right: 24px;
    }
  
    .action-buttons a {
      text-decoration: none;
      color: #333;
      padding: 0 16px;
      border-radius: 20px;
      transition: all 0.3s ease;
      border: 1px solid #ddd;
      height: 36px;
      display: flex;
      align-items: center;
      background: white;
    }
  
    .action-buttons a:hover {
      border-color: #4a90e2;
      color: #4a90e2;
    }
  
    .explore-dropdown {
      position: relative;
    }
  
    .explore-dropdown .dropdown {
      padding: 8px 16px;
      padding-right: 32px;
      border-radius: 20px;
      border: 1px solid #ddd;
      background: white;
      cursor: pointer;
      font-size: 14px;
      color: #333;
      appearance: none;
      -webkit-appearance: none;
      -moz-appearance: none;
      background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e");
      background-repeat: no-repeat;
      background-position: right 8px center;
      background-size: 16px;
      min-width: 100px;
      height: 40px;
      transition: all 0.3s ease;
    }
  
    .explore-dropdown .dropdown:hover {
      border-color: #4a90e2;
      color: #4a90e2;
    }
  
    .explore-dropdown .dropdown:focus {
      outline: none;
      border-color: #4a90e2;
      box-shadow: 0 0 0 2px rgba(74, 144, 226, 0.1);
    }
  
    .filters {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
      padding: 12px 24px;
      border-bottom: 1px solid #ddd;
      font-size: 14px;
      background: white;
      margin-top: 0;
    }
  
    .filter-group {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      background: #f8f9fa;
      padding: 8px;
      border-radius: 8px;
    }
  
    .filter-btn {
      padding: 8px 16px;
      border: 1px solid #ddd;
      border-radius: 20px;
      background: white;
      color: #333;
      font-size: 14px;
      cursor: pointer;
      transition: all 0.3s ease;
      white-space: nowrap;
    }
  
    .filter-btn:hover {
      border-color: #4a90e2;
      color: #4a90e2;
    }
  
    .filter-btn.active {
      background: #4a90e2;
      color: white;
      border-color: #4a90e2;
    }
  
    .content {
      padding: 24px;
    }
  
    .tags span {
      display: inline-block;
      margin: 4px 8px 4px 0;
      padding: 6px 12px;
      border: 1px solid #ccc;
      border-radius: 9999px;
      font-size: 14px;
      cursor: pointer;
    }
  
    .image-grid {
      columns: 4;
      column-gap: 20px;
      padding: 20px;
    }
  
    @media (max-width: 1200px) {
      .image-grid {
        columns: 3;
      }
    }
  
    @media (max-width: 768px) {
      .image-grid {
        columns: 2;
      }
    }
  
    @media (max-width: 480px) {
      .image-grid {
        columns: 1;
      }
    }
  
    .image-container {
      break-inside: avoid;
      margin-bottom: 20px;
      position: relative;
      border-radius: 12px;
      overflow: hidden;
      background: #f0f0f0;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      transition: transform 0.3s ease;
    }
  
    .image-container:hover {
      transform: translateY(-4px);
    }
  
    .image-container img {
      width: 100%;
      height: auto;
      display: block;
      object-fit: cover;
    }
  
    .image-overlay {
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      background: linear-gradient(to top, rgba(0,0,0,0.8), rgba(0,0,0,0.4) 50%, transparent);
      padding: 16px;
      opacity: 0;
      transition: opacity 0.3s ease;
    }
  
    .image-container:hover .image-overlay {
      opacity: 1;
    }
  
    .image-info {
      display: flex;
      justify-content: space-between;
      color: white;
      font-size: 14px;
      font-weight: 500;
    }
  
    .image-info span {
      display: flex;
      align-items: center;
      gap: 6px;
    }
  
    .image-item {
      cursor: pointer;
    }
  
    .error-message, .no-results {
      grid-column: 1 / -1;
      text-align: center;
      padding: 20px;
      color: #666;
      font-size: 16px;
    }
  
    .pagination {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 20px;
      margin: 30px 0;
      padding: 0 20px;
    }
  
    .pagination button {
      padding: 8px 16px;
      border-radius: 9999px;
      border: 1px solid #ddd;
      background: white;
      cursor: pointer;
      font-size: 14px;
      color: #333;
      transition: all 0.3s ease;
    }
  
    .pagination button:hover:not(:disabled) {
      background-color: #f0f0f0;
      border-color: #4a90e2;
      color: #4a90e2;
    }
  
    .pagination button:focus {
      outline: none;
      border-color: #4a90e2;
      box-shadow: 0 0 0 2px rgba(74, 144, 226, 0.1);
    }
  
    .pagination button:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      border-color: #ddd;
    }
  
    .page-info {
      font-size: 14px;
      color: #666;
    }
    .contact {
      background: #f8f9fa;
      padding: 4rem 2rem;
      text-align: center;
      border-top: 1px solid #e9ecef;
  }
  
  .contact-container {
      max-width: 800px;
      margin: 0 auto;
  }
  
  .contact h2 {
      font-size: 2.5rem;
      margin-bottom: 1rem;
      color: #343a40;
  }
  
  .contact p {
      font-size: 1.1rem;
      color: #495057;
      margin-bottom: 2rem;
  }
  
  .contact-details {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 1.5rem;
  }
  
  .contact-socials {
      display: flex;
      gap: 1.5rem;
  }
  
  .social-icon {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      color: #fff;
      font-size: 1.5rem;
      transition: background-color 0.3s ease;
  }
  
  .social-icon svg {
      width: 24px;
      height: 24px;
      fill: #6c757d;
      transition: fill 0.3s ease;
  }
  
  .social-icon:hover svg {
      fill: #007bff;
  }
  
  .facebook {
      background-color: #1877f2;
  }
  
  .twitter {
      background-color: #1da1f2;
  }
  
  .instagram {
      background: linear-gradient(45deg, #405de6, #5851db, #833ab4, #c13584, #e1306c, #fd1d1d);
  }
  
  .contact-email .email-link {
      display: inline-flex;
      align-items: center;
      gap: 0.75rem;
      text-decoration: none;
      color: #007bff;
      transition: color 0.3s ease;
  }
  
  .contact-email .email-link svg {
      width: 24px;
      height: 24px;
      fill: #6c757d;
      transition: fill 0.3s ease;
  }
  
  .contact-email .email-link:hover {
      color: #0056b3;
  }
  
  .contact-email .email-link:hover svg {
      fill: #0056b3;
  }
  
  @media (min-width: 768px) {
      .contact-details {
          flex-direction: row;
          justify-content: center;
          gap: 3rem;
      }
  }

  .logo img {
    width: 80px;
    height: auto;
  }

  @media (max-width: 600px) {
    .logo img {
      width: 60px;
    }
  }

  @media (max-width: 768px) {
    .filters {
      padding: 8px 16px;
    }
    
    .filter-group {
      width: 100%;
      overflow-x: auto;
      padding: 8px;
      -webkit-overflow-scrolling: touch;
    }
    
    .filter-btn {
      padding: 6px 12px;
      font-size: 13px;
    }
  }
  </style>
</head>

<body>
  <header>
    <div class="logo">
      <img src="Logo.png" alt="Vyliet">
    </div>
    <div class="search-container">
      <div class="search-input-wrapper">
        <svg class="search-icon" width="20" height="20" viewBox="0 0 20 20" fill="none"
          xmlns="http://www.w3.org/2000/svg">
          <path
            d="M9 17C13.4183 17 17 13.4183 17 9C17 4.58172 13.4183 1 9 1C4.58172 1 1 4.58172 1 9C1 13.4183 4.58172 17 9 17Z"
            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
          <path d="M19 19L14.65 14.65" stroke="currentColor" stroke-width="2" stroke-linecap="round"
            stroke-linejoin="round" />
        </svg>
        <input type="text" id="searchInput" placeholder="Search images...">
        <button class="clear-button" id="clearButton" title="Clear search">
          <svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M1 1L11 11M1 11L11 1" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
          </svg>
        </button>
      </div>
    </div>
    <div class="action-buttons">
      <a href="about-us.html" class="button" id="about-us-btn">About us</a>
      <a href="vyliet_login_verified.html" id="login-btn">Log in</a>
    </div>
  </header>

  <div class="filters">
    <div class="filter-group">
      <button class="filter-btn active" data-filter="type" data-value="all">All images</button>
      <button class="filter-btn" data-filter="type" data-value="photo">Photos</button>
      <button class="filter-btn" data-filter="type" data-value="illustration">Illustrations</button>
      <button class="filter-btn" data-filter="type" data-value="vector">Vectors</button>
    </div>
    <div class="filter-group">
      <button class="filter-btn active" data-filter="orientation" data-value="all">All orientation</button>
      <button class="filter-btn" data-filter="orientation" data-value="horizontal">Horizontal</button>
      <button class="filter-btn" data-filter="orientation" data-value="vertical">Vertical</button>
    </div>
    <div class="filter-group">
      <button class="filter-btn active" data-filter="size" data-value="all">All size</button>
      <button class="filter-btn" data-filter="size" data-value="480p">480p</button>
      <button class="filter-btn" data-filter="size" data-value="720p">720p</button>
      <button class="filter-btn" data-filter="size" data-value="1080p">1080p</button>
      <button class="filter-btn" data-filter="size" data-value="2k">2K</button>
      <button class="filter-btn" data-filter="size" data-value="4k">4K</button>
      <button class="filter-btn" data-filter="size" data-value="5k">5K</button>
      <button class="filter-btn" data-filter="size" data-value="8k">8K</button>
    </div>
  </div>

  <div class="image-grid" id="apiImageGrid">
    <!-- Images will be loaded here via JavaScript -->
  </div>

  <div class="pagination" id="pagination">
    <button class="prev-page" disabled>Previous</button>
    <span class="page-info">Page <span id="currentPage">1</span> of <span id="totalPages">1</span></span>
    <button class="next-page">Next</button>
  </div>
  </div>
  <section class="contact" id="contact">
    <div class="contact-container">
        <h2>Liên hệ với chúng tôi</h2>
        <p>Kết nối với chúng tôi trên mạng xã hội hoặc gửi email để được hỗ trợ!</p>
        <div class="contact-details">
            <div class="contact-socials">
                <a href="https://www.facebook.com" aria-label="Facebook" target="_blank" class="social-icon facebook">
                    <svg viewBox="0 0 24 24"><path fill="currentColor" d="M22.675 0h-21.35C.597 0 0 .6 0 1.333v21.333C0 23.4.597 24 1.325 24H12.82v-9.294H9.692v-3.622h3.128V8.413c0-3.1 1.894-4.788 4.66-4.788 1.325 0 2.464.099 2.795.143v3.24l-1.918.001c-1.504 0-1.795.715-1.795 1.763v2.312h3.587l-.467 3.622h-3.12V24h6.116c.728 0 1.325-.6 1.325-1.333V1.333C24 .6 23.403 0 22.675 0z"/></svg>
                </a>
                <a href="https://www.twitter.com" aria-label="Twitter" target="_blank" class="social-icon twitter">
                    <svg viewBox="0 0 24 24"><path fill="currentColor" d="M24 4.557a9.83 9.83 0 0 1-2.828.775 4.93 4.93 0 0 0 2.165-2.724 9.865 9.865 0 0 1-3.127 1.195 4.916 4.916 0 0 0-8.384 4.482A13.944 13.944 0 0 1 1.671 3.149a4.916 4.916 0 0 0 1.523 6.558 4.903 4.903 0 0 1-2.228-.616c-.054 2.281 1.581 4.415 3.949 4.89a4.934 4.934 0 0 1-2.224.085 4.918 4.918 0 0 0 4.588 3.417A9.867 9.867 0 0 1 .96 19.539a13.94 13.94 0 0 0 7.548 2.212c9.058 0 14.01-7.513 14.01-14.01 0-.213-.005-.425-.014-.636A10.025 10.025 0 0 0 24 4.557z"/></svg>
                </a>
                <a href="https://www.instagram.com" aria-label="Instagram" target="_blank" class="social-icon instagram">
                    <svg viewBox="0 0 24 24"><path fill="currentColor" d="M12 2.163c3.204 0 3.584.012 4.85.07 1.17.054 1.964.24 2.422.417a4.92 4.92 0 0 1 1.675 1.092 4.92 4.92 0 0 1 1.092 1.675c.177.458.363 1.252.417 2.422.058 1.266.069 1.646.069 4.85 0 3.204-.012 3.584-.069 4.85-.054 1.17-.24 1.964-.417 2.422a4.902 4.902 0 0 1-1.092 1.675 4.902 4.902 0 0 1-1.675 1.092c-.458.177-1.252.363-2.422.417C2.175 15.584 2.163 15.204 2.163 12c0-3.204.012-3.584.069-4.85.054-1.17.24-1.964.417-2.422a4.902 4.902 0 0 1 1.092-1.675 4.902 4.902 0 0 1 1.675-1.092c.458-.177 1.252-.363 2.422-.417C8.416 2.175 8.796 2.163 12 2.163zm0-2.163C8.735 0 8.332.012 7.052.07 5.773.128 4.842.308 4.042.563a7.077 7.077 0 0 0-2.572 1.037 7.077 7.077 0 0 0-1.038 2.572C.309 4.842.129 5.773.071 7.052.012 8.332 0 8.735 0 12s.012 3.668.07 4.948c.058 1.279.238 2.21.493 3.01a7.06 7.06 0 0 0 1.037 2.572 7.06 7.06 0 0 0 2.572 1.037c.8.255 1.731.435 3.01.493 1.28.058 1.683.07 4.948.07s3.668-.012 4.948-.07c1.279-.058 2.21-.238 3.01-.493a7.077 7.077 0 0 0 2.572-1.037 7.077 7.077 0 0 0 1.038-2.572c.255-.8.435-1.731.493-3.01.058-1.28.07-1.683.07-4.948s-.012-3.668-.07-4.948c-.058-1.279-.238-2.21-.493-3.01a7.06 7.06 0 0 0-1.037-2.572 7.06 7.06 0 0 0-2.572-1.037C14.21.309 13.279.129 12 .071 8.735.012 8.332 0 12 0zm0 5.838a6.162 6.162 0 1 0 0 12.324A6.162 6.162 0 0 0 12 5.838zm0 10.162a4 4 0 1 1 0-8 4 4 0 0 1 0 8zm6.406-11.845a1.44 1.44 0 1 1-2.88 0 1.44 1.44 0 0 1 2.88 0z"/></svg>
                </a>
            </div>
            <div class="contact-email">
                <a href="mailto:support@vyliet.com" class="email-link">
                    <svg viewBox="0 0 24 24"><path fill="currentColor" d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"/></svg>
                    <span>support@vyliet.com</span>
                </a>
            </div>
        </div>
    </div>
</section>

  <!-- Main application script -->
  <script>
    // API Configuration
    const PIXABAY_API_KEY = '49820812-01b57383da4bf4fe5a9de51d4';
    const PIXABAY_API_URL = 'https://pixabay.com/api/';
    const IMAGES_PER_PAGE = 20;
    const MAX_PAGES = 500; // Pixabay API limit

    // DOM Elements
    let searchInput;
    let clearButton;
    let imageGrid;
    let prevButton;
    let nextButton;
    let currentPageElement;
    let totalPagesElement;
    let currentPage = 1;
    let totalPages = 1;
    let currentQuery = '';

    // Initialize the application
    function init() {
      // Get DOM elements
      searchInput = document.getElementById('searchInput');
      clearButton = document.getElementById('clearButton');
      imageGrid = document.getElementById('apiImageGrid');
      prevButton = document.querySelector('.prev-page');
      nextButton = document.querySelector('.next-page');
      currentPageElement = document.getElementById('currentPage');
      totalPagesElement = document.getElementById('totalPages');
      const searchIcon = document.querySelector('.search-icon');

      if (!searchInput || !clearButton || !imageGrid || !prevButton || !nextButton || !currentPageElement || !totalPagesElement) {
        console.error('Required DOM elements not found');
        return;
      }

      // Set up event listeners
      setupEventListeners();

      // Set up filter button listeners
      setupFilterButtons();

      // Initial state
      updateClearButton();
      fetchImages();
    }

    // Set up all event listeners
    function setupEventListeners() {
      // Search input events
      searchInput.addEventListener('keypress', (e) => {
        if (e.key === 'Enter') {
          performSearch();
        }
      });

      // Search icon click event
      document.querySelector('.search-icon').addEventListener('click', performSearch);

      // Clear button events
      clearButton.addEventListener('click', handleClearButton);

      // Pagination events
      prevButton.addEventListener('click', () => changePage(currentPage - 1));
      nextButton.addEventListener('click', () => changePage(currentPage + 1));
    }

    // Set up filter button listeners
    function setupFilterButtons() {
      const filterButtons = document.querySelectorAll('.filter-btn');
      filterButtons.forEach(button => {
        button.addEventListener('click', () => {
          const filterGroup = button.closest('.filter-group');
          const filterType = button.dataset.filter;
          
          // Remove active class from all buttons in the same group
          filterGroup.querySelectorAll('.filter-btn').forEach(btn => {
            btn.classList.remove('active');
          });
          
          // Add active class to clicked button
          button.classList.add('active');
          
          // Update filter value
          const filterValue = button.dataset.value;
          if (window.filterManager) {
            window.filterManager.filters[filterType] = filterValue;
            window.filterManager.applyFilters();
          }
        });
      });
    }

    // Change page
    function changePage(newPage) {
      if (newPage < 1 || newPage > totalPages) return;
      currentPage = newPage;
      updatePaginationUI();
      fetchImages(currentQuery, currentPage);
    }

    // Update pagination UI
    function updatePaginationUI() {
      currentPageElement.textContent = currentPage;
      totalPagesElement.textContent = totalPages;
      prevButton.disabled = currentPage === 1;
      nextButton.disabled = currentPage === totalPages;
    }

    // Perform search
    function performSearch() {
      const query = searchInput.value.trim();
      if (query) {
        currentQuery = query;
        currentPage = 1;
        imageGrid.innerHTML = '';
        fetchImages(query, 1);
      }
    }

    // Handle clear button click
    function handleClearButton() {
      searchInput.value = '';
      searchInput.focus();
      updateClearButton();
      currentQuery = '';
      currentPage = 1;
      imageGrid.innerHTML = '';
    }

    // Update clear button visibility
    function updateClearButton() {
      const hasValue = searchInput.value.trim() !== '';
      clearButton.style.opacity = hasValue ? '1' : '0';
      clearButton.style.visibility = hasValue ? 'visible' : 'hidden';
    }

    // Fetch images from Pixabay API
    async function fetchImages(query = 'nature', page = 1) {
      try {
        const response = await fetch(`${PIXABAY_API_URL}?key=${PIXABAY_API_KEY}&q=${query}&per_page=${IMAGES_PER_PAGE}&page=${page}&image_type=photo&safesearch=true`);
        
        if (!response.ok) {
          throw new Error(`HTTP error! status: ${response.status}`);
        }
        
        const data = await response.json();
        console.log('API Response:', data); // For debugging
        
        // Update total pages based on API response
        const totalHits = Math.min(data.totalHits, MAX_PAGES * IMAGES_PER_PAGE);
        totalPages = Math.ceil(totalHits / IMAGES_PER_PAGE);
        console.log(`Total hits: ${data.totalHits}, Total pages: ${totalPages}`);
        
        displayImages(data.hits);
        updatePaginationUI();
      } catch (error) {
        console.error('Error fetching images:', error);
        imageGrid.innerHTML = '<div class="error-message">Failed to load images. Please try again later.</div>';
      }
    }

    // Display images in the grid
    function formatNumber(num) {
      if (!num && num !== 0) return '0';
      
      try {
        num = parseInt(num);
        if (isNaN(num)) return '0';
        
        if (num >= 1000000) {
          return (num / 1000000).toFixed(1) + 'M';
        }
        if (num >= 1000) {
          return (num / 1000).toFixed(1) + 'K';
        }
        return num.toString();
      } catch (e) {
        console.error('Error formatting number:', e);
        return '0';
      }
    }

    function displayImages(images) {
      imageGrid.innerHTML = '';

      if (!images || images.length === 0) {
        imageGrid.innerHTML = '<div class="no-results">No images found. Try a different search term.</div>';
        return;
      }

      console.log('API Response Data:', images); // Log API data

      images.forEach(photo => {
        // Validate photo object
        if (!photo || typeof photo !== 'object') {
          console.error('Invalid photo data:', photo);
          return;
        }

        const imgContainer = document.createElement('div');
        imgContainer.className = 'image-container';
        
        // Add data attributes for filtering
        imgContainer.dataset.type = photo.type || 'photo'; // Use API's type field
        imgContainer.dataset.orientation = photo.imageWidth > photo.imageHeight ? 'horizontal' : 'vertical';
        imgContainer.dataset.width = photo.imageWidth;
        imgContainer.dataset.height = photo.imageHeight;
        imgContainer.dataset.size = getSizeCategory(photo.imageWidth, photo.imageHeight);

        console.log('Image Data:', {
          type: imgContainer.dataset.type,
          orientation: imgContainer.dataset.orientation,
          width: imgContainer.dataset.width,
          height: imgContainer.dataset.height,
          size: imgContainer.dataset.size
        });

        const img = document.createElement('img');
        img.src = photo.webformatURL || '';
        img.alt = photo.tags || 'Image';
        img.loading = 'lazy';

        // Ensure numeric values
        const likes = parseInt(photo.likes) || 0;
        const downloads = parseInt(photo.downloads) || 0;
        const views = parseInt(photo.views) || 0;

        const imageInfo = {
          src: photo.webformatURL || '',
          alt: photo.tags || 'Image',
          likes: likes,
          downloads: downloads,
          views: views,
          user: photo.user || 'Unknown'
        };

        img.addEventListener('click', () => {
          localStorage.setItem("selectedImage", JSON.stringify(imageInfo));
          window.location.href = "Image_detail.html";
        });

        const overlay = document.createElement('div');
        overlay.className = 'image-overlay';
        overlay.innerHTML = `
            <div class="image-info">
                <span class="likes" title="${likes.toLocaleString()} likes">
                    ❤️ ${formatNumber(likes)}
                </span>
                <span class="downloads" title="${downloads.toLocaleString()} downloads">
                    ⬇️ ${formatNumber(downloads)}
                </span>
            </div>
        `;

        imgContainer.appendChild(img);
        imgContainer.appendChild(overlay);
        imageGrid.appendChild(imgContainer);
      });

      // Apply filters after images are loaded
      if (window.filterManager) {
        window.filterManager.applyFilters();
      }
    }

    // Helper function to determine size category
    function getSizeCategory(width, height) {
      const totalPixels = width * height;
      console.log('Image dimensions:', { width, height, totalPixels });
      
      if (totalPixels >= 7680 * 4320) return '8k';      // 8K: 7680x4320
      if (totalPixels >= 5120 * 2880) return '5k';      // 5K: 5120x2880
      if (totalPixels >= 3840 * 2160) return '4k';      // 4K: 3840x2160
      if (totalPixels >= 2560 * 1440) return '2k';      // 2K: 2560x1440
      if (totalPixels >= 1920 * 1080) return '1080p';   // 1080p: 1920x1080
      if (totalPixels >= 1280 * 720) return '720p';     // 720p: 1280x720
      if (totalPixels >= 854 * 480) return '480p';      // 480p: 854x480
      return 'small';
    }

    // Initialize the application when DOM is loaded
    document.addEventListener('DOMContentLoaded', init);

    function toggleDropdown(id) {
      document.getElementById(id).classList.toggle("show");
    }

    window.onclick = function (e) {
      const dropdowns = document.querySelectorAll(".dropdown");
      dropdowns.forEach((d) => {
        if (!d.contains(e.target)) {
          d.classList.remove("show");
        }
      });
    };

    document.addEventListener('DOMContentLoaded', function () {
      const searchInput = document.getElementById('searchInput');
      const clearButton = document.getElementById('clearButton');

      // Function to update clear button visibility
      function updateClearButton() {
        if (searchInput.value.trim() !== '') {
          clearButton.style.opacity = '1';
          clearButton.style.visibility = 'visible';
        } else {
          clearButton.style.opacity = '0';
          clearButton.style.visibility = 'hidden';
        }
      }

      // Clear button click handler
      clearButton.addEventListener('click', function () {
        searchInput.value = '';
        searchInput.focus();
        updateClearButton();
        fetchImages();
      });

      // Input change handler
      searchInput.addEventListener('input', updateClearButton);

      // Initial state
      updateClearButton();
    });

    document.addEventListener("DOMContentLoaded", () => {
      const imageGrid = document.getElementById("apiImageGrid");

      // Kiểm tra nếu imageGrid tồn tại
      if (!imageGrid) {
        console.error("Element with id 'apiImageGrid' not found.");
        return;
      }

      // Ví dụ: Tải ảnh động (thay thế bằng logic API của bạn)
      const images = [
        { id: 1, src: "image1.jpg", alt: "Image 1" },
        { id: 2, src: "image2.jpg", alt: "Image 2" },
        { id: 3, src: "image3.jpg", alt: "Image 3" },
      ];

      // Tạo các phần tử ảnh và thêm sự kiện click
      images.forEach((image) => {
        const imgElement = document.createElement("img");
        imgElement.src = image.src;
        imgElement.alt = image.alt;
        imgElement.classList.add("image-item");
        imgElement.dataset.id = image.id;

        // Thêm sự kiện click để lưu ảnh vào localStorage và chuyển hướng
        imgElement.addEventListener("click", () => {
          localStorage.setItem("selectedImage", JSON.stringify(image));
          window.location.href = "Image_detail.html";
        });

        imageGrid.appendChild(imgElement);
      });
    });

  </script>

<script>
  // Firebase initialization
  const firebaseConfig = {
    // Your Firebase config here
  };

  // Initialize Firebase
  firebase.initializeApp(firebaseConfig);
  const auth = firebase.auth();

  const loginBtn = document.querySelector('#login-btn');
  if (loginBtn) {
    auth.onAuthStateChanged(user => {
      if (user) {
        const img = document.createElement('img');
        img.src = user.photoURL || 'https://www.gravatar.com/avatar?d=mp&s=32';
        img.alt = 'Profile';
        img.style.width = '32px';
        img.style.height = '32px';
        img.style.borderRadius = '50%';
        img.style.objectFit = 'cover';
        img.style.cursor = 'pointer';

        const link = document.createElement('a');
        link.href = 'user-profile.html';
        link.id = 'profile-pic';
        link.appendChild(img);

        loginBtn.replaceWith(link);
      }
    });
  }
</script>
</body>
</html>